<div id="svc-emails"><script src="https://cdnjs.cloudflare.com/ajax/libs/jade/1.11.0/runtime.js"></script><script src="_template.js"></script><h2>Рассылка еженедельных писем, с недельным планом</h2><div class="rules"><p>Шаги для выполнения рассылки:</p><ol><li>Проверить, что работает CORS-proxy сервис <a target='_blank' href='https://thawing-chamber-8269.herokuapp.com'>https://thawing-chamber-8269.herokuapp.com</a>, если не работает - сообщить <a target='_blank' href='mailto:alexey@zorkaltsev.com'>alexey@zorkaltsev.com</a></li><li>Нажать "Подготовить рассылку"</li><li>Визуально проверить, что данные появившиеся ниже корректны</li><li>Ввести сегодняшнее число в поле "Дата рассылки" - для защиты от случайной рассылки</li><li>Нажмите "Отправить рассылку"</li><li>...не закрывайте эту страницу, пока не появится сообщение, что рассылка завершена</li></ol><p>Правила рассылки:</p><ol><li>Письмо отправляется на ящик исполнителю плюс в копию письма ставится адрес managers@webprofy.ru</li><li>Для дизайнеров в копию дописываются a.shevtsov@webprofy.ru и a.kolesnikov@webprofy.ru</li><li>Для верстальщиков в копию дописываются g.krasilnikov@webprofy.ru и s.yastrebov@webprofy.ru</li><li>Оранжевым выделяются часы для задач и задач в списках с название содержащим слово "бронь"</li><li>Письма уходят с адреса "Татьяна Верхотурова <t.verkhoturova@webprofy.ru>"</li><li>Задачи из списка <a target='_blank' href='http://teamwork.webprofy.ru/tasklists/462667'>ОТПУСКА</a> в план не включаются</li></ol></div><div class="controls"><span ng-if="state == &quot;inProgress&quot;" class="message inProgress">Рассылка в процесс - не закрывайте это окно!</span><span ng-if="state == &quot;completed&quot;" class="message completed">Рассылка завершена</span><span ng-if="state == &quot;error&quot;" class="message error">Поизошла ошибка.  Подробгности в console</span><button ng-click="prepare()" ng-disabled="emails" class="prepare">Подготовить рассылку</button><label for="control-field">Дата рассылки - сегодня (Пример.: 31.03.2015):</label><input name="control-field" type="text" ng-model="dateCheck"/><button ng-click="sendOut()" ng-disabled="!emails || !isDateCheckOk()" class="sendOut">Отправить рассылку</button></div><div class="report"><div ng-repeat="email in emails" class="person"><div class="name">{{$index}}. {{email.person.name}}: Привет, {{email.toName}}! (Итого: {{email.totalHours}})</div><div ng-class="{notSent: email.status == &quot;notSent&quot;, sent: email.status != &quot;notSent&quot;}" class="status">{{email.status == 'notSent' ? 'не отправлено' : 'отправлено'}}</div><table class="projects"><tr ng-repeat="project in email.projects"><td class="title">{{project.name}}</td><td ng-bind-html="project.hours" class="hours"></td><td class="manager">{{project.manager}}</td></tr></table></div></div></div>